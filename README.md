# net2blend

Export igraph networks from R and convert them to blender objects.

## How to use:
NOTE: Built under Blender 2.8

- Read the R function into R using source. 

- place the import_net.py file in your blender addon folder. Install using the addons menu - it'll be under the name "Import network". This will add an "import network"  category in the sidebar.

- Run the R function using an igraph object and other parameters as detailed below - this will export and edge csv and a vertex csv. 

-Then just select these files in the Blender panel and click "import network". Your network objects should appear (depending on the coordinates it might not be in view). 

-Alternatively you can point blender to a folder of networks with a set interval between them, or interval defined by the network suffix (netname2 in R).

## Detailed instructions:

### R

# net2blend
Arguments are similar to igraph.plot:

- net = Igraph network object
- layout = Layout matrix where first column is x coordinates and second column is y coordinates. Z coordinates can also be provided
- vertex.color = Vertex colour as hex or colour name. Default is red.
- edge.color = Edge colour as hex or colour name. Default is black.
- vertex.shape = Name of vertex shape. Can be "sphere","cube","circle","square" or "none". Can also be the name of an object in the blender scene. Default is sphere.
- vertex.size = Size of vertex. Default is 0.2
- edge.size = Edge size. Default is 0.1.
- edge.3d = Edges is a 3d object. If FALSE will flatten this edge. Default is 3d.
- edge.curve = Boolean:Should an edge be curved (defaults to 0.2) or numeric: Amount to curve edges. If a single value, this will be scaled by the length of the edges in the plot. Default is 0.
- edge.forcecurve= Boolean. If TRUE an edge will be set up so as to be curved in blender, even if edge.curve=0.
- vertex.intersect = Boolean. If TRUE edges will meet in the center of the vertex. If FALSE edges will be shortened by size of vertex. Default is TRUE
- vertex.edgeshorten = If provided, edges will be shortened by this value instead of the size of the vertex. Default is 0.
- edge.arrows= Boolean. If TRUE, plot arrowheads at the end of edges. Default is FALSE
- edge.arrowsize = Thickness of arrows. If edge.arrows is TRUE and no value is provided, is based on edge.size
- edge.arrowlength = Length of arrows. If edge.arrows is TRUE and no value is provided, this defaults to 0.2
- edge.dash = Size of dashed edges. Larger values result in a greater number of short dashes. Defaults to 0, no dash.
- edge.isdashed = Boolean. Should an edge be set up to be dashed even if the value of edge.dash is 0.
- zoffset1 = minimum amount to offset 2d edges below z coordinate to avoid clipping. Defaults to 0.01.
- zoffset2 = maximum amount to offset 2d edges below z coordinate to avoid clipping. Defaults to 0.05.
- directed = Boolean. Should be true for a directed network. In future this should be obtained from the net argument.
- outputdir = File path for export. Default is working directory
- netname = name to append as prefix to files. Format is netname_edata_netname2.csv or netname_vdata_netname2.csv
- netname2 = name to append as suffix to files. Format is netname_edata_netname2.csv or netname_vdata_netname2.csv. This is primarily for creating multiple versions of the same network for animation. If this is a number, this can be used to set the frame number in Blender.

# findmaxlength
Returns the maximum length of edge in a particular network/layout combo. This is used to keep curves consistent, as curve amount is based on the maximum edge length.
- net = Igraph network object
- layout = Layout matrix where first column is x coordinates and second column is y coordinates. Z coordinates can also be provided

# find_all_edges
Returns all edges in a list of networks as a matrix. These can then be added to all networks for consistency while animating using add_missing_edges
- allnets = list of Igraph network objects
- directed = Are these networks directed? False by default

# add_missing_edges
Adds edges to a network, if they are not present already and fill with an attribute. For example, edges not existing in certain versions of the network nethertheless need to be present in every version while animating in blender, and are assigned a size of 0 when not technically present.
- net = Igraph network object to which edges will be added
- alledges=Matrix of edges to be added (as generated by find_all_edges). If NULL (default) this will be all possible combinations of dyads. This can cause performance issues in blender for large networks!
- directed=Are the edges added directional? False by default
- selfloop=Are self loops to be added (if generating all possible combinations of edges). False by default.
- attrlist=List of attributes to be added to the new edges. For example, list(weight=0) for edges not technically present in a version of a network. Empty list by default.

# find_all_nodes
Returns all nodes in a list of networks as a matrix. These can then be added to all networks for consistency while animating using add_missing_nodes
- allnets =list of Igraph network objects

# add_missing_nodes
Add nodes to the network, if they are not present already, and fill with an attribute. For example, nodes not existing in certain versions of the network nethertheless need to be present in every version while animating in blender, and are assigned a size of 0 when not technically present.
- net = Igraph network object to which nodes will be added
- allnodes = vector of nodes (names or indices) to be added to the network
- attrlist= List of attributes to be assigned to the added nodes. Empty list by default.


### Blender
- You can either import networks one at a time or by folder.
- If importing single networks you will need to point Blender at the nodes and the edges folder and define a frame if you want to create an animation.
- If importing by folder, you will need to point Blender to the folder. You can then either add the networks at set frame intervals or based on their suffix. 
- The script creates two collections for convenience - nodes and edges, named based on the filenames If these collections already exist they will not be created again. 
- Nodes and edges will be created, each with a unique name. If these objects already exist in that collection they will be changed or have a keyframe added.
- As mentioned above, nodes can either be primitive spheres, cubes, circles or planes. Using a custom object is easy, just set the vertex.shape in R as the name of that object in Blender. If the object doesn't have materials, it'll be given the colour assigned in R, otherwise the existing materials are kept.
- If you run the script multiple times, make sure you purge orphaned data regularly as the curves used to generate edges will still be in the blender file otherwise, even if new edges have been generated.
